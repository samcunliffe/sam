"""Preselection strings.
Be carefll using these preselection strings. Best to check against the
version of the preselection in Sam's anacode framework src/preselection.cpp
if in doubt. Should trust that cpp code over this python.
"""
__author__ = "Sam Cunliffe"
__date__ = "11 June 2013" ## please check and update the date!!

# the bdt cuts
BDTACUT = "BDT10May13A > 0.21"
BDTBCUT = "BDT10May13B > 0.21"
BDTCUT = "(training_sample == 1)*(BDT10May13B > 0.21) + (training_sample == 2)*(BDT10May13A > 0.21)"

PRESELNOPEAKINGBKGVETOS = "(B0_M > 4850. && B0_M < 5780)&& asin(Pi_PT/Pi_P) > 0 && asin(Pi_PT/Pi_P) < 0.4&& asin(K_PT/K_P) > 0&& asin(K_PT/K_P) < 0.4&& asin(Muminus_PT/Muminus_P) > 0&& asin(Muminus_PT/Muminus_P) < 0.4&& asin(Muplus_PT/Muplus_P) > 0&& asin(Muplus_PT/Muplus_P) < 0.4&& Pi_hasRich > 0.5 && K_hasRich > 0.5&& B0_OWNPV_Z > -200 && B0_OWNPV_Z < 200 && B0_OWNPV_X > -5. && B0_OWNPV_X < 5. && B0_OWNPV_Y > -5. && B0_OWNPV_Y < 5&& Muplus_isMuon > 0.5 && Muminus_isMuon > 0.5&& K_TRACK_CHI2NDOF < 5. && Pi_TRACK_CHI2NDOF < 5.&& Muplus_TRACK_CHI2NDOF < 5.&& Muminus_TRACK_CHI2NDOF < 5.&& K_TRACK_CloneDist < 0. && Pi_TRACK_CloneDist < 0.&& Muminus_TRACK_CloneDist < 0.&& Muplus_TRACK_CloneDist < 0.&& B0_kstarAngSep > 0.001 && B0_jpsiAngSep > 0.001 && B0_piMuminusAngSep > 0.001 && B0_piMuplusAngSep > 0.001 && B0_kMuminusAngSep > 0.001 && B0_kMuplusAngSep>0.001&& B0_L0MuonDecision_TOS > 0.5 &&( B0_Hlt1TrackAllL0Decision_TOS > 0.5 || B0_Hlt1TrackMuonDecision_TOS > 0.5 )&& ( B0_Hlt2TopoMu2BodyBBDTDecision_TOS > 0.5 || B0_Hlt2TopoMu3BodyBBDTDecision_TOS > 0.5 || B0_Hlt2TopoMu4BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo2BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo3BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo4BodyBBDTDecision_TOS > 0.5 || B0_Hlt2SingleMuonDecision_TOS > 0.5 || B0_Hlt2DiMuonDetachedDecision_TOS > 0.5 )&& Pi_PIDK < 25.&& K_PIDK > -5&& Muminus_PIDmu > -3 && Muplus_PIDmu > -3&& (B0_ENDVERTEX_CHI2/B0_ENDVERTEX_NDOF) < 6&& (Kstar_ENDVERTEX_CHI2/Kstar_ENDVERTEX_NDOF) < 12&& (Jpsi_ENDVERTEX_CHI2/Jpsi_ENDVERTEX_NDOF) < 12&& B0_MINIPCHI2 < 16&& K_MINIPCHI2 > 9 && Pi_MINIPCHI2 > 9&& Muplus_MINIPCHI2 > 9 && Muminus_MINIPCHI2 > 9&& B0_DiraAngle < 0.01414225348&& B0_FDCHI2_OWNPV > 121&& Jpsi_FDCHI2_OWNPV > 9&& Kstar_FDCHI2_OWNPV > 9&& (((B0_M>5230&&!(B0_M>5330&&B0_M<5450))&&(Jpsi_M>3176.||Jpsi_M<2946.))||((B0_M<5230)&&(Jpsi_M>3176.||Jpsi_M<2796.))||((B0_M>5330&&B0_M<5450)&&(Jpsi_M>3216||Jpsi_M<2946)))&&(((B0_M>5230&&!(B0_M>5330&&B0_M<5450))&&(Jpsi_M>3766.||Jpsi_M<3586.))||((B0_M<5230)&&(Jpsi_M>3766.||Jpsi_M<3436.))||((B0_M>5330&&B0_M<5450)&&(Jpsi_M>3806||Jpsi_M<3586)))&& (Kstar_M > 600 && Kstar_M < 1200)"


ALEXVETO = "(K_PIDK - Pi_PIDK) > 10"
PRESELALEXPEAKINGVETOES = "(B0_M > 4850. && B0_M < 5780)&& asin(Pi_PT/Pi_P) > 0 && asin(Pi_PT/Pi_P) < 0.4&& asin(K_PT/K_P) > 0&& asin(K_PT/K_P) < 0.4&& asin(Muminus_PT/Muminus_P) > 0&& asin(Muminus_PT/Muminus_P) < 0.4&& asin(Muplus_PT/Muplus_P) > 0&& asin(Muplus_PT/Muplus_P) < 0.4&& Pi_hasRich > 0.5 && K_hasRich > 0.5&& B0_OWNPV_Z > -200 && B0_OWNPV_Z < 200 && B0_OWNPV_X > -5. && B0_OWNPV_X < 5. && B0_OWNPV_Y > -5. && B0_OWNPV_Y < 5&& Muplus_isMuon > 0.5 && Muminus_isMuon > 0.5&& K_TRACK_CHI2NDOF < 5. && Pi_TRACK_CHI2NDOF < 5.&& Muplus_TRACK_CHI2NDOF < 5.&& Muminus_TRACK_CHI2NDOF < 5.&& K_TRACK_CloneDist < 0. && Pi_TRACK_CloneDist < 0.&& Muminus_TRACK_CloneDist < 0.&& Muplus_TRACK_CloneDist < 0.&& B0_kstarAngSep > 0.001 && B0_jpsiAngSep > 0.001 && B0_piMuminusAngSep > 0.001 && B0_piMuplusAngSep > 0.001 && B0_kMuminusAngSep > 0.001 && B0_kMuplusAngSep>0.001&& B0_L0MuonDecision_TOS > 0.5 &&( B0_Hlt1TrackAllL0Decision_TOS > 0.5 || B0_Hlt1TrackMuonDecision_TOS > 0.5 )&& ( B0_Hlt2TopoMu2BodyBBDTDecision_TOS > 0.5 || B0_Hlt2TopoMu3BodyBBDTDecision_TOS > 0.5 || B0_Hlt2TopoMu4BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo2BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo3BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo4BodyBBDTDecision_TOS > 0.5 || B0_Hlt2SingleMuonDecision_TOS > 0.5 || B0_Hlt2DiMuonDetachedDecision_TOS > 0.5 )&& Pi_PIDK < 25.&& K_PIDK > -5&& Muminus_PIDmu > -3 && Muplus_PIDmu > -3&& (B0_ENDVERTEX_CHI2/B0_ENDVERTEX_NDOF) < 6&& (Kstar_ENDVERTEX_CHI2/Kstar_ENDVERTEX_NDOF) < 12&& (Jpsi_ENDVERTEX_CHI2/Jpsi_ENDVERTEX_NDOF) < 12&& B0_MINIPCHI2 < 16&& K_MINIPCHI2 > 9 && Pi_MINIPCHI2 > 9&& Muplus_MINIPCHI2 > 9 && Muminus_MINIPCHI2 > 9&& B0_DiraAngle < 0.01414225348&& B0_FDCHI2_OWNPV > 121&& Jpsi_FDCHI2_OWNPV > 9&& Kstar_FDCHI2_OWNPV > 9&& (K_PIDK - Pi_PIDK) > 10 &&(((B0_M>5230&&!(B0_M>5330&&B0_M<5450))&&(Jpsi_M>3176.||Jpsi_M<2946.))||((B0_M<5230)&&(Jpsi_M>3176.||Jpsi_M<2796.))||((B0_M>5330&&B0_M<5450)&&(Jpsi_M>3216||Jpsi_M<2946)))&&(((B0_M>5230&&!(B0_M>5330&&B0_M<5450))&&(Jpsi_M>3766.||Jpsi_M<3586.))||((B0_M<5230)&&(Jpsi_M>3766.||Jpsi_M<3436.))||((B0_M>5330&&B0_M<5450)&&(Jpsi_M>3806||Jpsi_M<3586)))&& (Kstar_M > 600 && Kstar_M < 1200)"

# jpsi window rather than veto
PRESELALEXPEAKINGVETOES_JPSIWIN= "(B0_M > 4850. && B0_M < 5780)&& asin(Pi_PT/Pi_P) > 0 && asin(Pi_PT/Pi_P) < 0.4&& asin(K_PT/K_P) > 0&& asin(K_PT/K_P) < 0.4&& asin(Muminus_PT/Muminus_P) > 0&& asin(Muminus_PT/Muminus_P) < 0.4&& asin(Muplus_PT/Muplus_P) > 0&& asin(Muplus_PT/Muplus_P) < 0.4&& Pi_hasRich > 0.5 && K_hasRich > 0.5&& B0_OWNPV_Z > -200 && B0_OWNPV_Z < 200 && B0_OWNPV_X > -5. && B0_OWNPV_X < 5. && B0_OWNPV_Y > -5. && B0_OWNPV_Y < 5&& Muplus_isMuon > 0.5 && Muminus_isMuon > 0.5&& K_TRACK_CHI2NDOF < 5. && Pi_TRACK_CHI2NDOF < 5.&& Muplus_TRACK_CHI2NDOF < 5.&& Muminus_TRACK_CHI2NDOF < 5.&& K_TRACK_CloneDist < 0. && Pi_TRACK_CloneDist < 0.&& Muminus_TRACK_CloneDist < 0.&& Muplus_TRACK_CloneDist < 0.&& B0_kstarAngSep > 0.001 && B0_jpsiAngSep > 0.001 && B0_piMuminusAngSep > 0.001 && B0_piMuplusAngSep > 0.001 && B0_kMuminusAngSep > 0.001 && B0_kMuplusAngSep>0.001&& B0_L0MuonDecision_TOS > 0.5 &&( B0_Hlt1TrackAllL0Decision_TOS > 0.5 || B0_Hlt1TrackMuonDecision_TOS > 0.5 )&& ( B0_Hlt2TopoMu2BodyBBDTDecision_TOS > 0.5 || B0_Hlt2TopoMu3BodyBBDTDecision_TOS > 0.5 || B0_Hlt2TopoMu4BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo2BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo3BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo4BodyBBDTDecision_TOS > 0.5 || B0_Hlt2SingleMuonDecision_TOS > 0.5 || B0_Hlt2DiMuonDetachedDecision_TOS > 0.5 )&& Pi_PIDK < 25.&& K_PIDK > -5&& Muminus_PIDmu > -3 && Muplus_PIDmu > -3&& (B0_ENDVERTEX_CHI2/B0_ENDVERTEX_NDOF) < 6&& (Kstar_ENDVERTEX_CHI2/Kstar_ENDVERTEX_NDOF) < 12&& (Jpsi_ENDVERTEX_CHI2/Jpsi_ENDVERTEX_NDOF) < 12&& B0_MINIPCHI2 < 16&& K_MINIPCHI2 > 9 && Pi_MINIPCHI2 > 9&& Muplus_MINIPCHI2 > 9 && Muminus_MINIPCHI2 > 9&& B0_DiraAngle < 0.01414225348&& B0_FDCHI2_OWNPV > 121&& Jpsi_FDCHI2_OWNPV > 9&& Kstar_FDCHI2_OWNPV > 9&& (K_PIDK - Pi_PIDK) > 10 && (Jpsi_M > 3036 && Jpsi_M < 3150) && (Kstar_M > 600 && Kstar_M < 1200)"


ANA2011VETOES = "K_PIDK>-5&&Pi_PIDK<25&&Muminus_PIDmu>-3&&Muplus_PIDmu>-3&&!((B0_ID>0)&&(B0_swapMass>3036)&&(B0_swapMass<3156)&&(Pi_PIDmu>5 || Pi_isMuon == 1 ))&&!((B0_ID<0)&&(B0_swapMass>3036)&&(B0_swapMass<3156)&&(Pi_PIDmu>5 || Pi_isMuon == 1))&&!((B0_ID>0)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))>3036)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))<3156)&&(K_PIDmu>5 || K_isMuon == 1))&&!((B0_ID<0)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))>3036)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))<3156)&&(K_PIDmu>5 || K_isMuon == 1))&&!(sqrt(Pi_M*Pi_M+K_M*K_M+2.*(sqrt(K_M*K_M+Pi_P*Pi_P)*sqrt(Pi_M*Pi_M+K_P*K_P)-(Pi_PX*K_PX+Pi_PY*K_PY+Pi_PZ*K_PZ)))>792&&sqrt(Pi_M*Pi_M+K_M*K_M+2.*(sqrt(K_M*K_M+Pi_P*Pi_P)*sqrt(Pi_M*Pi_M+K_P*K_P)-(Pi_PX*K_PX+Pi_PY*K_PY+Pi_PZ*K_PZ)))<992&&(K_PIDK+10<Pi_PIDK))&&!(B0_phiMass>1010&&B0_phiMass<1030&&B0_BsMass>5321&&B0_BsMass<5411 &&Pi_PIDK>-10.)&&!(B0_phiMass>1030&&B0_phiMass<1075&&B0_BsMass>5321&&B0_BsMass<5411 &&Pi_PIDK>10.)&&!(B0_M>5380&&B0_BuToKMuMuMass>5220&&B0_BuToKMuMuMass<5340)&&!( B0_Lambda_M_pK > (1520.-30.) && B0_Lambda_M_pK < (1520.+30.) &&  B0_LambdaB_M_pK > (5620.-45) && B0_LambdaB_M_pK < (5620.+45.) && Pi_PIDp > 15 )&&!( B0_Lambda_M_pK2 > (1520.-20.) && B0_Lambda_M_pK2 < (1520.+30.) && B0_LambdaB_M_pK2 > (5620.-45) && B0_LambdaB_M_pK2 < (5620.+45.) && Pi_PIDK > 10. )"

ANA2011VETOES_NOLAMBDASTUFF = "K_PIDK>-5&&Pi_PIDK<25&&Muminus_PIDmu>-3&&Muplus_PIDmu>-3&&!((B0_ID>0)&&(B0_swapMass>3036)&&(B0_swapMass<3156)&&(Pi_PIDmu>5 || Pi_isMuon == 1 ))&&!((B0_ID<0)&&(B0_swapMass>3036)&&(B0_swapMass<3156)&&(Pi_PIDmu>5 || Pi_isMuon == 1))&&!((B0_ID>0)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))>3036)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))<3156)&&(K_PIDmu>5 || K_isMuon == 1))&&!((B0_ID<0)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))>3036)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))<3156)&&(K_PIDmu>5 || K_isMuon == 1))&&!(sqrt(Pi_M*Pi_M+K_M*K_M+2.*(sqrt(K_M*K_M+Pi_P*Pi_P)*sqrt(Pi_M*Pi_M+K_P*K_P)-(Pi_PX*K_PX+Pi_PY*K_PY+Pi_PZ*K_PZ)))>792&&sqrt(Pi_M*Pi_M+K_M*K_M+2.*(sqrt(K_M*K_M+Pi_P*Pi_P)*sqrt(Pi_M*Pi_M+K_P*K_P)-(Pi_PX*K_PX+Pi_PY*K_PY+Pi_PZ*K_PZ)))<992&&(K_PIDK+10<Pi_PIDK))&&!(B0_phiMass>1010&&B0_phiMass<1030&&B0_BsMass>5321&&B0_BsMass<5411 &&Pi_PIDK>-10.)&&!(B0_phiMass>1030&&B0_phiMass<1075&&B0_BsMass>5321&&B0_BsMass<5411 &&Pi_PIDK>10.)&&!(B0_M>5380&&B0_BuToKMuMuMass>5220&&B0_BuToKMuMuMass<5340)"


FULLPRESEL = "(B0_M > 4850. && B0_M < 5780)&& asin(Pi_PT/Pi_P) > 0 && asin(Pi_PT/Pi_P) < 0.4&& asin(K_PT/K_P) > 0&& asin(K_PT/K_P) < 0.4&& asin(Muminus_PT/Muminus_P) > 0&& asin(Muminus_PT/Muminus_P) < 0.4&& asin(Muplus_PT/Muplus_P) > 0&& asin(Muplus_PT/Muplus_P) < 0.4&& Pi_hasRich > 0.5 && K_hasRich > 0.5&& B0_OWNPV_Z > -200 && B0_OWNPV_Z < 200 && B0_OWNPV_X > -5. && B0_OWNPV_X < 5. && B0_OWNPV_Y > -5. && B0_OWNPV_Y < 5&& Muplus_isMuon > 0.5 && Muminus_isMuon > 0.5&& K_TRACK_CHI2NDOF < 5. && Pi_TRACK_CHI2NDOF < 5.&& Muplus_TRACK_CHI2NDOF < 5.&& Muminus_TRACK_CHI2NDOF < 5.&& K_TRACK_CloneDist < 0. && Pi_TRACK_CloneDist < 0.&& Muminus_TRACK_CloneDist < 0.&& Muplus_TRACK_CloneDist < 0.&& B0_kstarAngSep > 0.001 && B0_jpsiAngSep > 0.001 && B0_piMuminusAngSep > 0.001 && B0_piMuplusAngSep > 0.001 && B0_kMuminusAngSep > 0.001 && B0_kMuplusAngSep>0.001&& B0_L0MuonDecision_TOS > 0.5 &&( B0_Hlt1TrackAllL0Decision_TOS > 0.5 || B0_Hlt1TrackMuonDecision_TOS > 0.5 )&& ( B0_Hlt2TopoMu2BodyBBDTDecision_TOS > 0.5 || B0_Hlt2TopoMu3BodyBBDTDecision_TOS > 0.5 || B0_Hlt2TopoMu4BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo2BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo3BodyBBDTDecision_TOS > 0.5 || B0_Hlt2Topo4BodyBBDTDecision_TOS > 0.5 || B0_Hlt2SingleMuonDecision_TOS > 0.5 || B0_Hlt2DiMuonDetachedDecision_TOS > 0.5 )&& Pi_PIDK < 25.&& K_PIDK > -5&& Muminus_PIDmu > -3 && Muplus_PIDmu > -3&& (B0_ENDVERTEX_CHI2/B0_ENDVERTEX_NDOF) < 6&& (Kstar_ENDVERTEX_CHI2/Kstar_ENDVERTEX_NDOF) < 12&& (Jpsi_ENDVERTEX_CHI2/Jpsi_ENDVERTEX_NDOF) < 12&& B0_MINIPCHI2 < 16&& K_MINIPCHI2 > 9 && Pi_MINIPCHI2 > 9&& Muplus_MINIPCHI2 > 9 && Muminus_MINIPCHI2 > 9&& B0_DiraAngle < 0.01414225348&& B0_FDCHI2_OWNPV > 121&& Jpsi_FDCHI2_OWNPV > 9&& Kstar_FDCHI2_OWNPV > 9&&K_PIDK>-5&&Pi_PIDK<25&&Muminus_PIDmu>-3&&Muplus_PIDmu>-3&&!((B0_ID>0)&&(B0_swapMass>3036)&&(B0_swapMass<3156)&&(Pi_PIDmu>5 || Pi_isMuon == 1 ))&&!((B0_ID<0)&&(B0_swapMass>3036)&&(B0_swapMass<3156)&&(Pi_PIDmu>5 || Pi_isMuon == 1))&&!((B0_ID>0)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))>3036)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))<3156)&&(K_PIDmu>5 || K_isMuon == 1))&&!((B0_ID<0)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))>3036)&&(sqrt(2.*((Muplus_M*Muplus_M)+(sqrt((K_P*K_P+Muplus_M*Muplus_M))*Muminus_PE)-(K_PX*Muminus_PX+K_PY*Muminus_PY+K_PZ*Muminus_PZ)))<3156)&&(K_PIDmu>5 || K_isMuon == 1))&&!(sqrt(Pi_M*Pi_M+K_M*K_M+2.*(sqrt(K_M*K_M+Pi_P*Pi_P)*sqrt(Pi_M*Pi_M+K_P*K_P)-(Pi_PX*K_PX+Pi_PY*K_PY+Pi_PZ*K_PZ)))>792&&sqrt(Pi_M*Pi_M+K_M*K_M+2.*(sqrt(K_M*K_M+Pi_P*Pi_P)*sqrt(Pi_M*Pi_M+K_P*K_P)-(Pi_PX*K_PX+Pi_PY*K_PY+Pi_PZ*K_PZ)))<992&&(K_PIDK+10<Pi_PIDK))&&!(B0_phiMass>1010&&B0_phiMass<1030&&B0_BsMass>5321&&B0_BsMass<5411 &&Pi_PIDK>-10.)&&!(B0_phiMass>1030&&B0_phiMass<1075&&B0_BsMass>5321&&B0_BsMass<5411 &&Pi_PIDK>10.)&&!(B0_M>5380&&B0_BuToKMuMuMass>5220&&B0_BuToKMuMuMass<5340)&&!( B0_Lambda_M_pK > (1520.-30.) && B0_Lambda_M_pK < (1520.+30.) &&  B0_LambdaB_M_pK > (5620.-45) && B0_LambdaB_M_pK < (5620.+45.) && Pi_PIDp > 15 )&&!( B0_Lambda_M_pK2 > (1520.-20.) && B0_Lambda_M_pK2 < (1520.+30.) && B0_LambdaB_M_pK2 > (5620.-45) && B0_LambdaB_M_pK2 < (5620.+45.) && Pi_PIDK > 10. )&& (K_PIDK - Pi_PIDK) > 10 &&(((B0_M>5230&&!(B0_M>5330&&B0_M<5450))&&(Jpsi_M>3176.||Jpsi_M<2946.))||((B0_M<5230)&&(Jpsi_M>3176.||Jpsi_M<2796.))||((B0_M>5330&&B0_M<5450)&&(Jpsi_M>3216||Jpsi_M<2946)))&&(((B0_M>5230&&!(B0_M>5330&&B0_M<5450))&&(Jpsi_M>3766.||Jpsi_M<3586.))||((B0_M<5230)&&(Jpsi_M>3766.||Jpsi_M<3436.))||((B0_M>5330&&B0_M<5450)&&(Jpsi_M>3806||Jpsi_M<3586)))&& (Kstar_M > 600 && Kstar_M < 1200)"


KSTARTIGHTWINDOW = "(Kstar_M < 992 && Kstar_M > 792)"
